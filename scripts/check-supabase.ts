console.log('üîç Environment Variables Check:')
console.log('DATABASE_URL:', process.env.DATABASE_URL ? 'SET' : 'NOT SET')
console.log('DIRECT_URL:', process.env.DIRECT_URL ? 'SET' : 'NOT SET')
console.log('')

if (process.env.DATABASE_URL) {
  console.log('üìç Database URL format check:')
  const url = process.env.DATABASE_URL
  console.log('Protocol:', url.startsWith('postgresql://') ? '‚úÖ PostgreSQL' : '‚ùå Not PostgreSQL')
  console.log('Host includes supabase.co:', url.includes('supabase.co') ? '‚úÖ Yes' : '‚ùå No')
  console.log('Port 5432:', url.includes(':5432') ? '‚úÖ Yes' : '‚ùå No')
  console.log('')
  console.log('Full URL (masked password):', url.replace(/:[^:]+@/, ':****@'))
}

// Try a simple ping to the host
console.log('üîç Testing host connectivity...')
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient({
  log: ['error'],
})

async function quickTest() {
  try {
    console.log('‚è≥ Attempting connection...')
    await prisma.$connect()
    console.log('‚úÖ Connected successfully!')
    
    const result = await prisma.$queryRaw`SELECT NOW() as current_time`
    console.log('üïê Database time:', result)
    
  } catch (error) {
    console.error('‚ùå Connection failed:')
    if (error instanceof Error) {
      console.error('Error message:', error.message)
      
      if (error.message.includes('timeout')) {
        console.log('\nüí° This appears to be a timeout issue.')
        console.log('Possible causes:')
        console.log('- Supabase project is paused')
        console.log('- Network connectivity issues')
        console.log('- Database is under maintenance')
      }
      
      if (error.message.includes('authentication')) {
        console.log('\nüí° This appears to be an authentication issue.')
        console.log('Check your database password in the connection string.')
      }
    }
  } finally {
    await prisma.$disconnect()
  }
}

quickTest()
